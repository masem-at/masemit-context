# Story 4.5: Company Tier Selection & Professional Polish

**Status:** Ready for Development
**Priority:** High (PoC Enhancement)
**Estimated Effort:** 2-3 days

---

## Overview

Replace the current industry-specific scenario buttons (Bakery, Hotel, Tech Startup) with three enterprise-relevant company tiers that better resonate with our target audience (finance professionals, controllers, BI consultants).

Each button displays a randomly generated whimsical company name (Neon-style) while the actual generated data uses professional industry-appropriate names.

---

## Business Context

**Problem:**
- Current scenarios (bakery, hotel) don't reflect the daily reality of our target audience
- Finance professionals work with mid-to-large enterprises, not small bakeries
- Demo data doesn't help prospects "see themselves" in the product

**Solution:**
- Three company tiers covering the enterprise spectrum
- Professional sectors (Finance, Industrials, Consumer Staples)
- Playful button names for memorable UX, professional output data

---

## The Three Company Tiers

| Tier | Sector | Size | Example Button | Generated Company Name |
|------|--------|------|----------------|------------------------|
| 1 | Finance | Large Cap | "Divine Tooth Inc." | "Meridian Capital Holdings" |
| 2 | Industrials | Mid Cap | "Broad Tree GmbH" | "Bauer Precision Manufacturing" |
| 3 | Consumer Staples | Startup | "Wild Flower Corp." | "Fresh Harvest Foods" |

---

## Task 1: Random Company Name Generator

**File:** `lib/utils/random-company-names.ts` (new)

Create a utility that generates whimsical two-word company names:

```typescript
// Word pools for random name generation
const ADJECTIVES = [
  'divine', 'broad', 'wild', 'silent', 'bright', 'swift', 'bold',
  'calm', 'deep', 'fair', 'golden', 'hidden', 'iron', 'jade',
  'keen', 'lost', 'mystic', 'noble', 'odd', 'pale', 'quick',
  'rare', 'sage', 'tall', 'vast', 'warm', 'young', 'zen'
]

const NOUNS = [
  'tooth', 'tree', 'flower', 'river', 'stone', 'cloud', 'wave',
  'peak', 'moon', 'star', 'leaf', 'storm', 'wind', 'frost',
  'dawn', 'dusk', 'echo', 'flame', 'grove', 'harbor', 'isle',
  'jewel', 'knight', 'light', 'marsh', 'nest', 'oak', 'pine'
]

// Suffix based on company tier
const SUFFIXES = {
  largecap: ['Inc.', 'Corp.', 'Holdings', 'Group'],
  midcap: ['GmbH', 'AG', 'Ltd.', 'Industries'],
  startup: ['Co.', 'Labs', 'Ventures', 'Studio']
}

export function generateRandomCompanyName(tier: CompanyTier): string
```

**Requirements:**
- Capitalize both words properly
- Select appropriate suffix based on tier
- Fresh generation on each call (no persistence needed)

---

## Task 2: Update ScenarioButtons Component

**File:** `components/landing/ScenarioButtons.tsx`

### 2.1 Update Types

```typescript
type CompanyTier = 'largecap' | 'midcap' | 'startup'

interface TierScenario {
  id: CompanyTier
  sector: string
  sectorCode: string  // GICS sector
  size: string
  icon: LucideIcon
  description: string
}
```

### 2.2 Update Scenario Configuration

```typescript
const tierScenarios: TierScenario[] = [
  {
    id: 'largecap',
    sector: 'Finance',
    sectorCode: 'financials',
    size: 'Large Cap',
    icon: Building2,  // or Landmark
    description: 'Enterprise financial services with complex reporting'
  },
  {
    id: 'midcap',
    sector: 'Industrials',
    sectorCode: 'industrials',
    size: 'Mid Cap',
    icon: Factory,
    description: 'Manufacturing operations with supply chain'
  },
  {
    id: 'startup',
    sector: 'Consumer Staples',
    sectorCode: 'consumer-staples',
    size: 'Startup',
    icon: Sprout,  // or Rocket
    description: 'Growth-stage consumer goods company'
  }
]
```

### 2.3 Update Button Layout

Each button should display:

```
┌─────────────────────────────┐
│  [Icon]                     │
│                             │
│  Divine Tooth Inc.          │  ← Random name (large, bold)
│                             │
│  Sector: Finance            │  ← Sector label
│  Size: Large Cap            │  ← Size label
│                             │
│  Enterprise financial...    │  ← Description (smaller)
│                          →  │
└─────────────────────────────┘
```

### 2.4 Generate Names on Component Mount

```typescript
const [companyNames, setCompanyNames] = useState<Record<CompanyTier, string>>({
  largecap: '',
  midcap: '',
  startup: ''
})

useEffect(() => {
  // Generate fresh names on mount (page load)
  setCompanyNames({
    largecap: generateRandomCompanyName('largecap'),
    midcap: generateRandomCompanyName('midcap'),
    startup: generateRandomCompanyName('startup')
  })
}, [])
```

---

## Task 3: Backend - Tier-Specific Generation Parameters

### 3.1 Create Tier Configuration

**File:** `lib/config/company-tiers.ts` (new)

```typescript
export interface TierConfig {
  tier: CompanyTier
  sector: string
  sectorCode: string
  size: string

  // Generation parameters
  companyName: string  // Professional name for generated data
  currency: string
  region: string

  // Revenue scale
  baseMonthlyRevenue: { min: number; max: number }

  // Headcount
  employeeCount: { min: number; max: number }

  // Event volume per quarter
  eventsPerQuarter: { min: number; max: number }

  // Salary ranges by role type
  salaryRanges: {
    executive: { min: number; max: number }
    manager: { min: number; max: number }
    specialist: { min: number; max: number }
    junior: { min: number; max: number }
  }

  // Product/service count
  productCount: { min: number; max: number }

  // Narrative context for prompts
  narrativeContext: string
}

export const TIER_CONFIGS: Record<CompanyTier, TierConfig> = {
  largecap: {
    tier: 'largecap',
    sector: 'Finance',
    sectorCode: 'financials',
    size: 'Large Cap',
    companyName: 'Meridian Capital Holdings',
    currency: 'EUR',
    region: 'Europe',
    baseMonthlyRevenue: { min: 5_000_000, max: 15_000_000 },
    employeeCount: { min: 500, max: 2000 },
    eventsPerQuarter: { min: 25, max: 40 },
    salaryRanges: {
      executive: { min: 15000, max: 35000 },
      manager: { min: 8000, max: 15000 },
      specialist: { min: 5000, max: 8000 },
      junior: { min: 3000, max: 5000 }
    },
    productCount: { min: 8, max: 15 },
    narrativeContext: 'Established financial services firm. Focus on quarterly earnings, regulatory compliance, cost optimization, and potential M&A activity.'
  },

  midcap: {
    tier: 'midcap',
    sector: 'Industrials',
    sectorCode: 'industrials',
    size: 'Mid Cap',
    companyName: 'Bauer Precision Manufacturing',
    currency: 'EUR',
    region: 'Europe',
    baseMonthlyRevenue: { min: 800_000, max: 3_000_000 },
    employeeCount: { min: 100, max: 500 },
    eventsPerQuarter: { min: 18, max: 30 },
    salaryRanges: {
      executive: { min: 10000, max: 20000 },
      manager: { min: 5000, max: 10000 },
      specialist: { min: 3500, max: 6000 },
      junior: { min: 2500, max: 3500 }
    },
    productCount: { min: 5, max: 10 },
    narrativeContext: 'Established manufacturing company. Focus on production efficiency, supply chain management, capacity planning, and market expansion.'
  },

  startup: {
    tier: 'startup',
    sector: 'Consumer Staples',
    sectorCode: 'consumer-staples',
    size: 'Startup',
    companyName: 'Fresh Harvest Foods',
    currency: 'EUR',
    region: 'Europe',
    baseMonthlyRevenue: { min: 50_000, max: 200_000 },
    employeeCount: { min: 10, max: 50 },
    eventsPerQuarter: { min: 12, max: 20 },
    salaryRanges: {
      executive: { min: 5000, max: 8000 },
      manager: { min: 3500, max: 5500 },
      specialist: { min: 2800, max: 4000 },
      junior: { min: 2000, max: 3000 }
    },
    productCount: { min: 3, max: 6 },
    narrativeContext: 'Growth-stage consumer goods startup. Focus on rapid scaling, burn rate management, customer acquisition, and Series A/B metrics.'
  }
}
```

### 3.2 Create Tier-Aware Prompt Templates

**File:** `lib/prompts/tier-scenario.ts` (new)

Create new prompt templates that use TierConfig to generate appropriate data:

```typescript
export function getTierStage1Prompt(config: TierConfig): string {
  // Use config values for:
  // - Company name, sector, region
  // - Employee count ranges
  // - Salary ranges by role
  // - Product/service count
  // - Narrative context
}

export function getTierStage2Prompt(masterData: any, config: TierConfig): string {
  // Use config values for:
  // - Revenue ranges
  // - Seasonal patterns appropriate to sector
  // - Employee lifecycle events
}

export function getTierStage3QuarterlyPrompt(
  masterData: any,
  trends: any,
  quarter: number,
  quarterMonths: string[],
  config: TierConfig
): string {
  // Use config values for:
  // - Event volume
  // - Transaction sizes
  // - Financial metrics scale
}
```

### 3.3 Update Generator to Use Tier Config

**File:** `lib/generators/scenario-generator.ts` (or equivalent)

- Accept `CompanyTier` parameter instead of scenario type
- Load appropriate TierConfig
- Pass config to prompt templates
- Ensure Zod schemas accommodate tier variations

---

## Task 4: Update API Routes

**Files:**
- `app/api/generate/route.ts`
- `app/generate/loading/page.tsx`

Update to accept `tier` parameter instead of `type`:

```typescript
// Old: /api/generate?type=bakery
// New: /api/generate?tier=largecap
```

Ensure backward compatibility or migrate fully.

---

## Task 5: Update Loading Page

**File:** `app/generate/loading/page.tsx`

Update progress messages to reflect tier:

```typescript
const tierMessages = {
  largecap: [
    'Initializing enterprise data structures...',
    'Generating financial services portfolio...',
    'Building compliance frameworks...',
    'Calculating quarterly projections...'
  ],
  midcap: [
    'Setting up manufacturing operations...',
    'Configuring supply chain data...',
    'Generating production schedules...',
    'Building cost center hierarchy...'
  ],
  startup: [
    'Creating startup profile...',
    'Modeling growth trajectory...',
    'Generating product catalog...',
    'Building runway projections...'
  ]
}
```

---

## Task 6: Update Comparison Data Utility

**File:** `lib/utils/comparison-data.ts`

Add tier-specific growth rates:

```typescript
const TIER_GROWTH_RATES: Record<CompanyTier, GrowthRates> = {
  largecap: {
    historical: 0.03,      // Stable, mature
    planGrowth: 0.05,      // Conservative targets
    forecastGrowth: 0.04   // Realistic
  },
  midcap: {
    historical: 0.06,
    planGrowth: 0.10,
    forecastGrowth: 0.08
  },
  startup: {
    historical: 0.15,
    planGrowth: 0.30,      // Ambitious
    forecastGrowth: 0.20   // More realistic
  }
}
```

---

## Task 7: Update My Scenarios List Page

**File:** `app/scenarios/page.tsx`

Update the scenarios list to display the new tier-based structure instead of "Bakery Scenario", "Hotel Scenario", etc.

### 7.1 Update Scenario Interface

```typescript
interface Scenario {
  id: string
  scenarioType: string  // Now stores tier: 'largecap' | 'midcap' | 'startup'
  status: string
  createdAt: string
  completedAt: string | null
  validationPassed: boolean | null
  // Add these fields (from DB or derived):
  companyName?: string   // Professional name from generation
  sector?: string        // Finance, Industrials, Consumer Staples
  size?: string          // Large Cap, Mid Cap, Startup
}
```

### 7.2 Update Scenario Card Display

Replace current display:
```
❌ "Bakery Scenario" with generic icon
```

With new display:
```
┌─────────────────────────────────────────────────────────┐
│  [Tier Icon]  Meridian Capital Holdings                 │
│                                                         │
│  Sector: Finance          Size: Large Cap               │
│                                                         │
│  Created: Dec 10, 2024    Status: ✓ completed           │
│  ID: abc-123-def                                        │
└─────────────────────────────────────────────────────────┘
```

### 7.3 Add Tier-Specific Icons

```typescript
import { Building2, Factory, Sprout } from 'lucide-react'

const getTierIcon = (tier: string) => {
  switch (tier) {
    case 'largecap':
      return <Building2 className="h-6 w-6 text-blue-600" />
    case 'midcap':
      return <Factory className="h-6 w-6 text-blue-600" />
    case 'startup':
      return <Sprout className="h-6 w-6 text-blue-600" />
    default:
      return <BarChart3 className="h-6 w-6 text-blue-600" />
  }
}
```

### 7.4 Display Tier Metadata

Show sector and size as labels/badges:

```tsx
<div className="flex gap-2">
  <span className="px-2 py-1 bg-gray-100 rounded text-xs text-gray-700">
    {scenario.sector}
  </span>
  <span className="px-2 py-1 bg-blue-50 rounded text-xs text-blue-700">
    {scenario.size}
  </span>
</div>
```

### 7.5 Backward Compatibility

For existing scenarios (bakery, hotel, techStartup), show legacy display:

```typescript
const isLegacyScenario = ['bakery', 'hotel', 'techStartup'].includes(scenario.scenarioType)

if (isLegacyScenario) {
  // Show old format: "Bakery Scenario" with generic icon
} else {
  // Show new format: Company name + Sector + Size
}
```

---

## Task 8: Database Schema Consideration

**File:** `prisma/schema.prisma` (if needed)

Consider whether to:
1. Store `companyName`, `sector`, `size` as separate columns in Scenario table
2. Or derive them from `scenarioType` using TIER_CONFIGS lookup

**Recommendation:** Derive from scenarioType for now (simpler, no migration needed). Store explicitly only if we later allow custom company names.

---

## Acceptance Criteria

### Frontend - Landing Page
- [ ] Three buttons display with random company names
- [ ] Names regenerate on page refresh
- [ ] Sector and Size labels visible on each button
- [ ] Icons appropriate to each tier
- [ ] Responsive layout maintained

### Frontend - My Scenarios Page
- [ ] New scenarios show company name, sector, and size
- [ ] Tier-specific icons display correctly
- [ ] Legacy scenarios (bakery, hotel) still display properly
- [ ] Cards are visually consistent with landing page tiers

### Backend
- [ ] Generation uses tier-specific parameters
- [ ] Revenue scales match tier (startup ~100k, largecap ~10M monthly)
- [ ] Employee counts match tier
- [ ] Generated company uses professional name (not random button name)
- [ ] Zod validation passes for all tiers

### Data Quality
- [ ] Financial data is internally consistent
- [ ] Headcount aligns with salary expenses
- [ ] Revenue aligns with product sales events
- [ ] IBCS scenarios (AC, PY, PL, FC) display correctly

---

## Out of Scope (Future)

- Region dimension (multiple regions per company)
- Custom company name input
- Industry/sector selection dropdown
- Fine-tuning prompts per GICS sub-sector

---

## References

- Current prompts: `lib/prompts/bakery-scenario.ts`
- Current buttons: `components/landing/ScenarioButtons.tsx`
- IBCS patterns: `components/charts/IBCSPatterns.tsx`
- Post-PoC architecture: `docs/architecture/post-poc-event-architecture.md`
